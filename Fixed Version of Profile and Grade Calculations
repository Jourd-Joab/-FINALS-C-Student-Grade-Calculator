#include <iostream>
#include <algorithm>
#include <iomanip>
#include <string>
#include <limits>

using namespace std;

// Function to check if the name is valid (only letters and spaces)
bool isValidName(const string& name) {
    for (char c : name) {
        if (!isalpha(c) && c != ' ') return false; // not a letter or space means invalid
    }
    return !name.empty(); // name cannot be empty
}

// Function to check if the ID is valid numbers and dashes only
bool isValidID(const string& id) {
    for (char c : id) {
        if (!isdigit(c) && c != '-') return false; // only digits and dashes are accepted
    }
    return !id.empty(); // ID cannot be empty
}

// Function to get a valid name
string getValidName(string prompt) {
    string name;
    while (true) {
        cout << prompt;
        getline(cin, name);
        if (isValidName(name)) return name; // returns valid name
        cout << "Invalid input. Please enter your name with letters and spaces only.\n";
    }
}

// Function to get a valid ID
string getValidID(string prompt) {
    string id;
    while (true) {
        cout << prompt;
        getline(cin, id);
        if (isValidID(id)) return id; // returns valid ID
        cout << "Invalid input. Enter numbers with dashes or just numbers (like 06-2024-017).\n";
    }
}

// Function to get a valid age (only numbers)
int getValidInt(string prompt) {
    string input;
    int value;
    while (true) {
        cout << prompt;
        getline(cin, input);

        bool valid = true;
        for (char c : input) {
            if (!isdigit(c)) { // only digits are allowed for age
                valid = false;
                break;
            }
        }

        if (valid && !input.empty()) {
            value = stoi(input);
            if (value >= 0) return value; // age must be zero or higher
        }

        cout << "Invalid input. Please enter numbers only (no dashes or letters).\n";
    }
}

// Function to get a valid grade level 1-12, numbers only
int getValidGradeLevel(string prompt) {
    string input;
    int level;
    while (true) {
        cout << prompt;
        getline(cin, input);

        bool valid = true;
        for (char c : input) {
            if (!isdigit(c)) { // only digits are allowed for grade level
                valid = false;
                break;
            }
        }

        if (valid && !input.empty()) {
            level = stoi(input);
            if (level >= 1 && level <= 12) return level; // grade level must be 1 to 12
        }

        cout << "Invalid input. Please enter a grade level from 1 to 12 (numbers only).\n";
    }
}

// Function to get a valid subject grade (1-100 only)
float getValidGrade(string prompt) {
    string input;
    float grade;
    while (true) {
        cout << prompt;
        getline(cin, input);

        bool valid = true;
        for (char c : input) {
            if (!isdigit(c) && c != '.') { // digits and one decimal point allowed
                valid = false;
                break;
            }
        }

        if (valid && !input.empty()) {
            grade = stof(input);
            if (grade >= 1 && grade <= 100) return grade; // grade must be between 1 and 100
        }

        cout << "Invalid input. Please enter a grade between 1 and 100.\n";
    }
}

// Function to add suffix to grade level like 1st, 2nd, 3rd, etc
string getGradeSuffix(int gradeLevel) {
    if (gradeLevel == 1) return "1st Grade";
    if (gradeLevel == 2) return "2nd Grade";
    if (gradeLevel == 3) return "3rd Grade";
    return to_string(gradeLevel) + "th Grade"; // for all the other grade levels
}

// This finds the average grade.
float calculateAverage(float mathGrade, float scienceGrade, float englishGrade, float historyGrade, float artGrade){
    return (mathGrade + scienceGrade + englishGrade + historyGrade + artGrade) / 5;
}

// This finds the highest grade.
float findHighest(float mathGrade, float scienceGrade, float englishGrade, float historyGrade, float artGrade){
    return max({mathGrade, scienceGrade, englishGrade, historyGrade, artGrade});
}

// This finds the lowest grade.
float findLowest(float mathGrade, float scienceGrade, float englishGrade, float historyGrade, float artGrade){
    return min({mathGrade, scienceGrade, englishGrade, historyGrade, artGrade});
}

// This gives the equivalent grade (1.00 - 5.00).
float getGrade(float average){
    if (average >= 96 && average <= 100) {
        return 1.00f;
    }
    else if (average >= 94 && average <= 95.9) {
        return 1.25f;
    }
    else if (average >= 92 && average <= 93.9) {
        return 1.50f;
    }
    else if (average >= 90 && average <= 91.9) {
        return 1.75f;
    }
    else if (average >= 88 && average <= 89.9) {
        return 2.00f;
    }
    else if (average >= 86 && average <= 87.9) {
        return 2.25f;
    }
    else if (average >= 84 && average <= 85.9) {
        return 2.50f;
    }
    else if (average >= 82 && average <= 83.9) {
        return 2.75f;
    }
    else if (average >= 80 && average <= 81.9){
        return 3.00f;
    }
    else if (average >= 0 && average <= 79.9) {
        return 5.00f;
    }
    else{
        cout << "ERROR: Invalid input" << endl;
        return 0;
    }
}

// This counts how many passing grades (>=60) there are.
int countPassing(float mathGrade, float scienceGrade, float englishGrade, float historyGrade, float artGrade){
    float grades[] = {mathGrade, scienceGrade, englishGrade, historyGrade, artGrade};
    
    int count_grade = 0;
    for (float i : grades){
        if (i >= 60.0)
           count_grade++; 
    }
    return count_grade;
}

int main(){
    cout << "========================================\n";
    cout << "         STUDENT GRADE CALCULATOR\n";
    cout << "========================================\n\n";
    
    cout << "=== STUDENT PROFILE SETUP ===\n";
    string studentName = getValidName("Enter student name: ");
    string studentID = getValidID("Enter student ID: ");
    int age = getValidInt("Enter student age (numbers only): ");
    int gradeLevel = getValidGradeLevel("Enter grade level (1-12): ");

    cout << "\nProfile created successfully!\n\n";
    
    cout << "=== GRADE ENTRY ===\n";
    float mathGrade = getValidGrade("Enter Math grade (1-100): ");
    float scienceGrade = getValidGrade("Enter Science grade (1-100): ");
    float englishGrade = getValidGrade("Enter English grade (1-100): ");
    float historyGrade = getValidGrade("Enter History grade (1-100): ");
    float artGrade = getValidGrade("Enter Art grade (1-100): ");

    cout << "\nGrades recorded successfully!\n\n";

    cout << "========================================\n";
    cout << "           STUDENT REPORT CARD\n";
    cout << "========================================\n";
    cout << "STUDENT INFORMATION\n";
    cout << "Name: " << studentName << endl;
    cout << "ID: " << studentID << endl;
    cout << "Age: " << age << " years old\n";
    cout << "Grade Level: " << getGradeSuffix(gradeLevel) << "\n";
    cout << "Birth Year: " << (2025 - age) << "\n\n";
    
    float average_grade = calculateAverage(mathGrade, scienceGrade, englishGrade, historyGrade, artGrade);
    float equivalent_grade = getGrade(average_grade);
    float highest_grade = findHighest(mathGrade, scienceGrade, englishGrade, historyGrade, artGrade);
    float lowest_grade = findLowest(mathGrade, scienceGrade, englishGrade, historyGrade, artGrade);
    int passing_grades = countPassing(mathGrade, scienceGrade, englishGrade, historyGrade, artGrade);
    
    cout << "SUBJECT GRADES:" << endl;
    cout << "Math: " << mathGrade << "%" << endl;
    cout << "Science: " << scienceGrade << "%" << endl;
    cout << "English: " << englishGrade << "%" << endl;
    cout << "History: " << historyGrade << "%" << endl;
    cout << "Art: " << artGrade << "%" << endl;
    cout << endl;
    cout << "GRADE STATISTICS:" << endl;
    cout << "Average Grade: " << average_grade << "%" << endl;
    cout << "Grade Equivalent: " << fixed << setprecision(2) << equivalent_grade << endl;
    cout << "Highest Grade: " << highest_grade << "%" << endl;
    cout << "Lowest Grade: " << lowest_grade << "%" << endl;
    cout << "Subjects Passed: " << passing_grades << " out of 5" << endl;
    cout << "========================================\n";
    return 0;
}
